import pandas as pd

# Class for opening the database csv file and searching it
class Database(object):
    def __init__(self, place):
        self.data = pd.read_csv('data/places.csv', index_col=0)
        self.search(place)

    def search(self, pluscode):
        result = {}
        codes = self.data['plus_code'].values
        for index in range(len(codes)):
            if str(codes[index]) == place.plus_code:
                result = {
                    "found": True,
                    "subtype":self.data.at[index, 'subtype'],
                    "masks": self.data.at[index, 'masks'],
                    "lim_entry": self.data.at[index, 'limited_entry'],
                    "early_close": self.data.at[index, 'early_close'],
                    "has_early": self.data.at[index, 'has_early'],
                    "early_hours": self.data.at[index, 'early_hours'],
                    "delivery": self.data.at[index, 'delivery']
                }
                return result
        return None
